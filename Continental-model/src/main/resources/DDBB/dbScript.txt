-- public.clients definition

 

-- Drop table

 

-- DROP TABLE public.clients;

 

CREATE TABLE public.clients (

idclient int4 NOT NULL DEFAULT nextval('clients_id_seq'::regclass),

"document" varchar(20) NOT NULL,

"name" varchar(100) NOT NULL,

countrycode varchar(2) NOT NULL,

clientdowndate date NULL,

CONSTRAINT clients_pkey PRIMARY KEY (idclient)

);

 

 

-- public.hotels definition

 

-- Drop table

 

-- DROP TABLE public.hotels;

 

CREATE TABLE public.hotels (

id int4 NOT NULL DEFAULT nextval('hoteles_id_seq'::regclass),

"name" varchar(255) NOT NULL,

address varchar(255) NOT NULL,

hoteldowndate date NULL,

CONSTRAINT hoteles_pkey PRIMARY KEY (id)

);

 

 

-- public.trole definition

 

-- Drop table

 

-- DROP TABLE public.trole;

 

CREATE TABLE public.trole (

id_rolename int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,

rolename varchar(255) NULL,

xmlclientpermission varchar(10485760) NULL,

CONSTRAINT trole_pkey PRIMARY KEY (id_rolename)

);

 

 

-- public.tserver_permission definition

 

-- Drop table

 

-- DROP TABLE public.tserver_permission;

 

CREATE TABLE public.tserver_permission (

id_server_permission int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,

permission_name varchar(10485760) NULL,

CONSTRAINT tserver_permission_pkey PRIMARY KEY (id_server_permission)

);

 

 

-- public.tuser definition

 

-- Drop table

 

-- DROP TABLE public.tuser;

 

CREATE TABLE public.tuser (

user_ varchar(50) NOT NULL,

"password" varchar(50) NULL,

"name" varchar(50) NULL,

surname varchar(50) NULL,

email varchar(50) NULL,

nif varchar(50) NULL,

lastpasswordupdate timestamp NULL DEFAULT CURRENT_TIMESTAMP,

firstlogin bool NULL DEFAULT true,

user_down_date varchar NULL,

CONSTRAINT tuser_pkey PRIMARY KEY (user_)

);

 

 

-- public.accesscards definition

 

-- Drop table

 

-- DROP TABLE public.accesscards;

 

CREATE TABLE public.accesscards (

accesscardid serial4 NOT NULL,

hotelid int4 NULL,

CONSTRAINT accesscards_pkey PRIMARY KEY (accesscardid),

CONSTRAINT fk_accesscards_hotels FOREIGN KEY (hotelid) REFERENCES public.hotels(id)

);

 

 

-- public.employees definition

 

-- Drop table

 

-- DROP TABLE public.employees;

 

CREATE TABLE public.employees (

employeeid serial4 NOT NULL,

"document" varchar(255) NULL,

"name" varchar(255) NULL,

hotelid int4 NULL,

employeedowndate date NULL,

CONSTRAINT employees_pkey PRIMARY KEY (employeeid),

CONSTRAINT employees_hotelid_fkey FOREIGN KEY (hotelid) REFERENCES public.hotels(id)

);

 

 

-- public.rooms definition

 

-- Drop table

 

-- DROP TABLE public.rooms;

 

CREATE TABLE public.rooms (

roomid int4 NOT NULL DEFAULT nextval('habitaciones_idhabitacion_seq'::regclass),

hotelid int4 NOT NULL,

roomnumber int4 NOT NULL,

roomdowndate date NULL,

CONSTRAINT habitaciones_pkey PRIMARY KEY (roomid),

CONSTRAINT habitaciones_idhotel_fkey FOREIGN KEY (hotelid) REFERENCES public.hotels(id)

);

 

 

-- public.trole_server_permission definition

 

-- Drop table

 

-- DROP TABLE public.trole_server_permission;

 

CREATE TABLE public.trole_server_permission (

id_role_server_permission int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,

id_rolename int4 NULL,

id_server_permission int4 NULL,

CONSTRAINT trole_server_permission_pkey PRIMARY KEY (id_role_server_permission),

CONSTRAINT fk_trole_server_permission FOREIGN KEY (id_rolename) REFERENCES public.trole(id_rolename) ON DELETE CASCADE,

CONSTRAINT fk_tserver_permission FOREIGN KEY (id_server_permission) REFERENCES public.tserver_permission(id_server_permission)

);

 

 

-- public.tuser_role definition

 

-- Drop table

 

-- DROP TABLE public.tuser_role;

 

CREATE TABLE public.tuser_role (

id_user_role int4 NOT NULL GENERATED BY DEFAULT AS IDENTITY,

id_rolename int4 NULL,

user_ varchar(50) NULL,

CONSTRAINT tuser_role_pkey PRIMARY KEY (id_user_role),

CONSTRAINT fk_trole FOREIGN KEY (id_rolename) REFERENCES public.trole(id_rolename) ON DELETE CASCADE,

CONSTRAINT fk_tuser FOREIGN KEY (user_) REFERENCES public.tuser(user_)

);

 

 

-- public.bookings definition

 

-- Drop table

 

-- DROP TABLE public.bookings;

 

CREATE TABLE public.bookings (

bookingid int4 NOT NULL DEFAULT nextval('reservas_idreserva_seq'::regclass),

roomid int4 NOT NULL,

initialdate date NOT NULL,

enddate date NOT NULL,

clientid int4 NOT NULL,

checkindatetime timestamp NULL,

checkoutdatetime timestamp NULL,

CONSTRAINT reservas_pkey PRIMARY KEY (bookingid),

CONSTRAINT bookings_clientid_fkey FOREIGN KEY (clientid) REFERENCES public.clients(idclient),

CONSTRAINT reservas_idhabitacion_fkey FOREIGN KEY (roomid) REFERENCES public.rooms(roomid) ON DELETE CASCADE ON UPDATE CASCADE

);

 

 

-- public.accesscard_booking definition

 

-- Drop table

 

-- DROP TABLE public.accesscard_booking;

 

CREATE TABLE public.accesscard_booking (

accesscardasignment serial4 NOT NULL,

accesscardid int4 NULL,

bookingid int4 NULL,

CONSTRAINT accesscard_booking_pkey PRIMARY KEY (accesscardasignment),

CONSTRAINT accesscard_booking_accesscardid_fkey FOREIGN KEY (accesscardid) REFERENCES public.accesscards(accesscardid),

CONSTRAINT accesscard_booking_bookingid_fkey FOREIGN KEY (bookingid) REFERENCES public.bookings(bookingid)

);